<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Interclasse - Inscrições</title>

<!-- Fonte -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
  :root{
    --blue-600: #ff3b3b;
    --blue-500:#ff3b3b;
    --bg:#f3f5f7;
    --card:#ffffff;
  }

  body{
    margin:0;
    font-family:"Poppins",sans-serif;
    background:var(--bg);
  }

  header{
    background:#ffffff;
    border-bottom:6px solid #d71920; /* barra CPS */
    padding:18px 0;
  }
  .header-container{
    max-width:1100px;
    margin:0 auto;
    padding:0 18px;
    display:flex;
    align-items:center;
    justify-content:space-between;
  }
  header h1{
    margin:0;
    color:#111;
    font-weight:700;
  }

  .admin-btn{
    background:#fff;
    color:#d71920;
    padding:8px 14px;
    border-radius:10px;
    border:2px solid #d71920;
    font-weight:700;
    cursor:pointer;
  }
  .admin-btn:hover{
    background:#d71920;
    color:white;
  }

  /* Form */
  .container{
    max-width:900px;
    margin:28px auto;
    background:white;
    padding:28px;
    border-radius:16px;
    box-shadow:0 8px 26px rgba(0,0,0,0.08);
  }

  label{ font-weight:600; margin-top:14px; display:block; }
  input,select{
    width:100%;
    padding:12px;
    margin-top:8px;
    border-radius:8px;
    border:1px solid #ccc;
  }

  .btn-primary{
    width:100%;
    background:var(--blue-600);
    color:white;
    border:0;
    padding:12px;
    border-radius:10px;
    margin-top:20px;
    font-weight:700;
    cursor:pointer;
  }
  .btn-primary:hover{ background:#f07171 }

  /* Admin panel */
  #admin-panel{
    max-width:1100px;
    margin:26px auto;
    padding:22px;
    background:white;
    border-radius:14px;
    box-shadow:0 8px 26px rgba(0,0,0,0.08);
    display:none;
  }

  table{
    width:100%;
    border-collapse:collapse;
    margin-top:12px;
  }
  th,td{
    padding:10px;
    border-bottom:1px solid #eee;
    font-size:14px;
  }
  th{
    background:#f1f5ff;
    font-weight:700;
  }
  .del-btn{
    background:#ff3b3b;
    border:0;
    padding:6px 8px;
    border-radius:8px;
    color:white;
    cursor:pointer;
  }
</style>
</head>

<body>

<header>
  <div class="header-container">
    <h1>Interclasse - Inscrições</h1>
    <button class="admin-btn" onclick="openAdminLogin()">ADMIN</button>
  </div>
</header>

<!-- FORMULÁRIO -->
<div class="container" id="form-container">
  <h2>Formulário de Inscrição</h2>

  <form id="registerForm">
    <label>Nome</label>
    <input id="name" required>

    <label>Turma</label>
    <select id="turma" required>
      <option value="">Selecionar...</option>
      <option>1ADI</option>
      <option>1MAI</option>
      <option>1NTD</option>
      <option>VERDE</option>
      <option>2MAI</option>
      <option>2MKT</option>
      <option>3MAI</option>
      <option>3MKT</option>
    </select>

    <label>Modalidade</label>
    <select id="modality" required></select>

    <button class="btn-primary" type="submit">Enviar Inscrição</button>
  </form>
</div>

<div id="admin-panel">
  <h2>Painel do Administrador</h2>

  <label style="font-weight:600;">Filtrar por modalidade:</label>
  <select id="filterMod" onchange="loadTable()" style="padding:10px; border-radius:8px; margin-bottom:12px;"></select>

  <table>
    <thead>
      <tr><th>Nome</th><th>Turma</th><th>Modalidade</th><th>Data</th><th>Ações</th></tr>
    </thead>
    <tbody id="table-body"></tbody>
  </table>

  <button onclick="resetAll()" 
          style="background:#ff3b3b;color:#fff;padding:10px 14px;border-radius:10px;border:0;margin-top:12px;">
    Resetar Tudo
  </button>
</div>


<script>

const STORAGE_KEY = "inter_regs_v1";

let regs = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

const LIMITS = {
  "Vôlei Misto": 12,
  "Futsal Masculino": 10,
  "Futsal Feminino": 10,
  "Atletismo Salto em Distância": 2,
  "Xadrez Misto": 2,
  "Uno Misto": 2,
  "Tabuada": 2,
  "Soletrando": 2,
  "Fifa": 2,
  "Pebolim": 3,
  "Handebol Feminino": 10,
  "Tênis de mesa Masculino": 2,
  "Tênis de mesa Feminino": 2,
  "Free Fire": 6,
  "Clash Royale": 2
};

const ALL_MODALITIES = Object.keys(LIMITS);


const BLOCK_FOR_VERDE = [
  "Futsal Masculino",
  "Futsal Feminino",
  "Handebol Feminino",
  "Fifa",
  "Free Fire",
  "Clash Royale"
];

const selTurma = document.getElementById("turma");
const selMod   = document.getElementById("modality");

function updateModalities(){
  selMod.innerHTML = "<option value=''>Selecionar...</option>";
  const turma = selTurma.value;
  if(!turma) return;

  ALL_MODALITIES.forEach(mod => {
    if(turma === "VERDE" && BLOCK_FOR_VERDE.includes(mod)) return;

    const used = regs.filter(r => r.turma === turma && r.modality === mod).length;
    if(used < LIMITS[mod]){
      selMod.innerHTML += `<option>${mod}</option>`;
    }
  });
}

selTurma.addEventListener("change", updateModalities);


document.getElementById("registerForm").addEventListener("submit", e=>{
  e.preventDefault();
  
  const name  = document.getElementById("name").value.trim();
  const turma = selTurma.value;
  const mod   = selMod.value;

  if(!name || !turma || !mod) return alert("Preencha tudo!");

  const used = regs.filter(r => r.turma === turma && r.modality === mod).length;
  if(used >= LIMITS[mod]){
    alert("Limite atingido!");
    updateModalities();
    return;
  }

  regs.push({
    name, turma, modality: mod,
    created: new Date().toISOString()
  });

  localStorage.setItem(STORAGE_KEY, JSON.stringify(regs));

  alert("Inscrição realizada!");
  e.target.reset();
  updateModalities();
});


/* pagina admin login*/
function openAdminLogin(){
  const senha = prompt("Digite a senha do administrador:");
  if(senha === "2304"){
    document.getElementById("form-container").style.display = "none";
    document.getElementById("admin-panel").style.display = "block";
    loadFilter();
    loadTable();
  } else {
    alert("Senha incorreta!");
  }
}


/* pagina admin filtro/tabela */
const filterMod = document.getElementById("filterMod");
const tableBody = document.getElementById("table-body");

function loadFilter(){
  filterMod.innerHTML = "<option value=''>Todas</option>";
  ALL_MODALITIES.forEach(m => 
    filterMod.innerHTML += `<option>${m}</option>`
  );
}

function loadTable(){
  regs = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

  let list = [...regs];

  if(filterMod.value){
    list = list.filter(r => r.modality === filterMod.value);
  }

  list.sort((a,b)=>{
    if(a.turma < b.turma) return -1;
    if(a.turma > b.turma) return 1;
    return a.name.localeCompare(b.name);
  });

  tableBody.innerHTML = "";
  list.forEach(r=>{
    tableBody.innerHTML += `
      <tr>
        <td>${r.name}</td>
        <td>${r.turma}</td>
        <td>${r.modality}</td>
        <td>${new Date(r.created).toLocaleString()}</td>
        <td><button class="del-btn" onclick="delReg('${r.created}')">Excluir</button></td>
      </tr>`;
  });
}

function delReg(created){
  if(!confirm("Excluir?")) return;
  regs = regs.filter(r => r.created !== created);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(regs));
  loadTable();
}


/* apagar tudo */
function resetAll(){
  if(!confirm("Tem certeza?")) return;
  localStorage.removeItem(STORAGE_KEY);
  regs = [];
  loadTable();
  alert("Limpo!");
}
</script>

</body>
</html>
